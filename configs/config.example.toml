# iter-service Configuration Reference
# =====================================
#
# This file documents ALL available configuration options with their defaults.
# You do NOT need to include all these settings in your config.toml.
# Only specify values you want to override - defaults are set in code.
#
# Environment variables: Use ${VAR_NAME} syntax
# Path expansion: Use ~ for home directory
#
# Minimal config.toml example:
#   [llm]
#   api_key = "${GEMINI_API_KEY}"
#
#   [logging]
#   level = "debug"

# =============================================================================
# SERVICE - Core service settings
# =============================================================================
[service]
# Network binding (can override with ITER_HOST, ITER_PORT env vars)
host = "127.0.0.1"                    # Host to bind to
port = 8420                           # Port to listen on

# Data storage (defaults to ~/.iter-service on Linux)
# data_dir = "~/.iter-service"        # Data directory
# pid_file = "~/.iter-service/iter-service.pid"

# Server behavior
shutdown_timeout_seconds = 30         # Graceful shutdown timeout
max_request_size_bytes = 10485760     # Max request body (10MB)

# =============================================================================
# API - REST API settings
# =============================================================================
[api]
enabled = true                        # Enable REST API
api_key = ""                          # API key (empty = no auth for localhost)
rate_limit_per_minute = 100           # Rate limit (0 = unlimited)
request_timeout_seconds = 60          # Request timeout

# CORS origins
allowed_origins = [
    "http://localhost:*",
    "http://127.0.0.1:*"
]

# =============================================================================
# MCP - Model Context Protocol settings
# =============================================================================
[mcp]
enabled = true                        # Enable MCP server
auto_build_index = true               # Auto-build index on start

# =============================================================================
# LLM - Language model integration
# =============================================================================
[llm]
provider = "gemini"                   # Provider: gemini, openai, anthropic
api_key = "${GEMINI_API_KEY}"         # API key (use env var)
model = "gemini-1.5-flash"            # Model name
max_tokens = 1024                     # Max response tokens
temperature = 0.3                     # Temperature (0.0-1.0)
timeout_seconds = 30                  # Request timeout

# =============================================================================
# INDEX - Code indexing settings
# =============================================================================
[index]
# File watching
watch_enabled = true                  # Enable file watching
debounce_ms = 500                     # Debounce time for file changes

# Size limits
max_file_size_bytes = 1048576         # Max file size to index (1MB)
max_symbols_per_file = 1000           # Max symbols per file

# Embedding model for semantic search
embedding_model = "nomic-embed-text-v1.5"

# Patterns to exclude from indexing
exclude_globs = [
    "vendor/**",
    "node_modules/**",
    ".git/**",
    "*.min.js",
    "*.min.css",
    "dist/**",
    "build/**",
    "__pycache__/**",
    "*.pyc",
    ".venv/**",
    "target/**"
]

# File extensions to include
include_extensions = [
    ".go", ".py", ".js", ".ts", ".tsx", ".jsx",
    ".java", ".kt", ".scala", ".rs", ".c", ".cpp",
    ".h", ".hpp", ".cs", ".rb", ".php", ".swift",
    ".m", ".mm", ".sql", ".sh", ".bash", ".zsh"
]

# =============================================================================
# LOGGING - Log settings (powered by arbor)
# =============================================================================
[logging]
level = "info"                        # Level: debug, info, warn, error, trace
format = "text"                       # Format: json, text
output = ["file"]                     # Output destinations: file, stdout (array)
time_format = "15:04:05.000"          # Go time format for timestamps
max_size_mb = 100                     # Max log file size before rotation
max_backups = 5                       # Number of backup files to keep
max_age_days = 30                     # Max age of log files
compress = true                       # Compress rotated logs

# =============================================================================
# SECURITY - TLS and security settings
# =============================================================================
[security]
cors_enabled = true                   # Enable CORS
tls_enabled = false                   # Enable TLS/HTTPS

# TLS certificate files (required if tls_enabled = true)
# tls_cert_file = "/path/to/cert.pem"
# tls_key_file = "/path/to/key.pem"
